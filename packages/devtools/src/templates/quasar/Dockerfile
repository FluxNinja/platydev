# ! ########################################################################### ! #
# ! #|     THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY     |# ! #
# ! ########################################################################### ! #

FROM node:14-alpine as builder
RUN npm i lerna @quasar/cli -g --loglevel error
USER node
RUN mkdir /home/node/app
WORKDIR /home/node/app

COPY --chown=node:node package.json yarn.lock lerna.json tsconfig.json tsconfig.build.json .eslintrc.js .eslintignore ./
# {{#each packages}}
COPY --chown=node:node {{this.installFiles}} /home/node/app/{{this.path}}/
# {{/each}}

RUN lerna bootstrap --ignore-scripts
# {{#each packages}}
COPY --chown=node:node {{this.path}} /home/node/app/{{this.path}}
# {{/each}}

RUN cd {{directory}}/{{name}} && quasar build

FROM nginx:alpine
COPY --from=builder /home/node/app/{{directory}}/{{name}}/dist/spa /usr/share/nginx/html
